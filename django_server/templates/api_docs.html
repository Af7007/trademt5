<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation - MLP Trading System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .endpoint { margin-bottom: 20px; border-left: 4px solid #007bff; padding-left: 15px; }
        .method { font-weight: bold; padding: 2px 6px; border-radius: 3px; }
        .method-get { background-color: #28a745; color: white; }
        .method-post { background-color: #dc3545; color: white; }
        .highlight { background-color: #fff3cd !important; }
        code { background-color: #f1f3f4; padding: 2px 4px; border-radius: 3px; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">
                üéØ MLP Trading System - API Documentation
            </a>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="alert alert-info">
            <h4>üìã Arquitetura Sistema:</h4>
            <ul>
                <li><strong>Flask API (Porta 5000):</strong> Sistema completo de trading e rotas `/mlp/*, /bot/*`</li>
                <li><strong>Django Dashboard (Porta 5001):</strong> Interface administrativa e esta documenta√ß√£o</li>
                <li><strong>MCP Server (Porta 3000):</strong> Interface LLM com ferramentas</li>
            </ul>
        </div>

        <div class="jumbotron bg-light p-4">
            <h1 class="display-5">üìä Reference Completo da API</h1>
            <p class="lead">Documenta√ß√£o t√©cnica das APIs do sistema MLP Trading System</p>
            <p><strong>Django Dashboard:</strong> <code>http://localhost:5001</code></p>
        </div>

        <!-- Flask API Principal -->
        <div class="card mt-4">
            <div class="card-header bg-success text-white">
                <h5>üöÄ Flask API - Sistema de Trading (Porta 5000)</h5>
            </div>
            <div class="card-body">
                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/health</code>
                    <p>Health check geral do sistema Flask</p>
                    <p class="text-muted">Response: { "mt5_connected": true/false, "status": "healthy" }</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/btcusd/stats</code>
                    <p>Dados completos de mercado BTC/USD com volatilidade</p>
                    <p class="text-muted">Response: Pre√ßo atual, spread, volume em tempo real</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/btcusd/indicators/M1</code>
                    <p>Indicadores t√©cnicos para timeframe M1</p>
                    <p class="text-muted">Response: RSI, MACD, Bollinger Bands calculados</p>
                </div>

                <div class="endpoint">
                    <span class="method method-post">POST</span>
                    <code>/mlp/start</code>
                    <p>Inicia bot MLP autom√°tico para trading</p>
                    <p class="text-muted">Response: Status de inicializa√ß√£o do bot</p>
                </div>

                <div class="endpoint">
                    <span class="method method-post">POST</span>
                    <code>/mlp/stop</code>
                    <p>Para execu√ß√£o do bot MLP</p>
                    <p class="text-muted">Response: Confirma√ß√£o de parada</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/mlp/status</code>
                    <p>Status atual do bot e conex√µes</p>
                    <p class="text-muted">Response: MT5 status, bot running, positions</p>
                </div>

                <div class="endpoint">
                    <span class="method method-post">POST</span>
                    <code>/mlp/execute</code>
                    <p>Executar sinal BUY/SELL com confian√ßa</p>
                    <p class="text-muted">Body: { "signal": "BUY", "confidence": 0.85 }</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/mlp/performance</code>
                    <p>M√©tricas de performance do sistema</p>
                    <p class="text-muted">Response: Win rate, P&L, drawdown, stats</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/mlp/positions</code>
                    <p>Posi√ß√µes abertas atuais no MT5</p>
                    <p class="text-muted">Response: Lista de posi√ß√µes ativas</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/bot/health</code>
                    <p>Health check da API Bot integrada</p>
                    <p class="text-muted">Response: Status do sistema Bot MLP</p>
                </div>
            </div>
        </div>

        <!-- Django Dashboard -->
        <div class="card mt-4">
            <div class="card-header bg-info text-white">
                <h5>üìä Django Dashboard - Interface Administrativa (Porta 5001)</h5>
            </div>
            <div class="card-body">
                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/admin/</code>
                    <p>Admin Django - Gerenciamento do banco de dados</p>
                    <p class="text-muted">Login: superuser (para gerenciamento)</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/quant/mlp/</code>
                    <p>Dashboard principal MLP Bot</p>
                    <p class="text-muted">Interface visual para controle do sistema</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/quant/mlp/control/</code>
                    <p>Painel de controle MLP com comandos live</p>
                    <p class="text-muted">Bot√£o iniciar/parar, an√°lises, trades</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/quant/mlp/trades/</code>
                    <p>Hist√≥rico de trades realizado</p>
                    <p class="text-muted">Tabela com todos os trades MLP</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/quant/mlp/analyses/</code>
                    <p>Hist√≥rico de an√°lises realizadas</p>
                    <p class="text-muted">An√°lises t√©cnicas por per√≠odo</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/quant/daily-pnl/</code>
                    <p>P&L di√°rio consolidado</p>
                    <p class="text-muted">Gr√°fico e tabela de performance di√°ria</p>
                </div>
            </div>
        </div>

        <!-- MCP Server LLM -->
        <div class="card mt-4">
            <div class="card-header bg-warning text-dark">
                <h5>ü§ñ MCP Server - Interface LLM (Porta 3000)</h5>
            </div>
            <div class="card-body">
                <div class="alert alert-warning">
                    <strong>‚ùáÔ∏è Protocolo MCP:</strong> Model Context Protocol para integra√ß√£o com LLMs (Claude, GPT-4, etc.)
                </div>

                <h6>üìã Ferramentas Dispon√≠veis:</h6>
                <div class="row">
                    <div class="col-md-6">
                        <ul class="list-group mb-3">
                            <li class="list-group-item">üìä <strong>get_market_data</strong> - Dados em tempo real MT5</li>
                            <li class="list-group-item">ü§ñ <strong>get_mlp_signal</strong> - Sinal inteligente AI</li>
                            <li class="list-group-item">üìà <strong>get_trade_history</strong> - Hist√≥rico de trades</li>
                            <li class="list-group-item">‚ö° <strong>execute_trade</strong> - Executar opera√ß√µes</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <ul class="list-group mb-3">
                            <li class="list-group-item">üìä <strong>get_performance</strong> - M√©tricas performance</li>
                            <li class="list-group-item">üíº <strong>get_portfolio</strong> - Status portf√≥lio</li>
                            <li class="list-group-item">‚öôÔ∏è <strong>get_bot_status</strong> - Status operacional</li>
                        </ul>
                    </div>
                </div>

                <div class="endpoint">
                    <span class="method method-post">POST</span>
                    <code>/tools/call</code>
                    <p>Chamada de ferramentas MCP</p>
                    <p class="text-muted">Body: { "tool": "nome", "parameters": {...} }</p>
                </div>

                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <code>/health</code>
                    <p>Health check MCP Server</p>
                    <p class="text-muted">Response: Status de conex√µes do sistema</p>
                </div>

                <div class="mt-3 p-3 bg-light rounded">
                    <h6>üìù Como Usar com LLMs:</h6>
                    <pre><code># Exemplo com Claude/GPT-4
curl -X POST http://localhost:3000/tools/call \
  -H "Content-Type: application/json" \
  -d '{"tool": "get_market_data", "parameters": {}}'</code></pre>
                </div>
            </div>
        </div>

        <!-- WebSocket MetaTrader -->
        <div class="card mt-4 highlight">
            <div class="card-header bg-danger text-white">
                <h5>üîÑ WebSocket - MetaTrader Integration</h5>
            </div>
            <div class="card-body">
                <div class="alert alert-danger">
                    <strong>‚ö° Comunica√ß√£o Real-time:</strong> Para conectar MetaTrader com o sistema via WebSocket
                </div>

                <div class="endpoint">
                    <span class="method method-get">WS</span>
                    <code>ws://localhost:3000</code>
                    <p>WebSocket MCP Server para MetaTrader</p>
                    <p class="text-muted">Protocolo: WebSocket | Porta: 3000 | Path: /</p>
                </div>

                <div class="mt-3 p-3 bg-warning text-dark rounded">
                    <h6>üìù Configura√ß√£o MetaTrader (MQL5):</h6>
                    <pre><code>// No Expert Advisor
#define WS_HOST "localhost"
#define WS_PORT 3000
string ws_url = "ws://" + WS_HOST + ":" + IntegerToString(WS_PORT) + "/";

// Conex√£o WebSocket
WebSocket_Connect(ws_url);</code></pre>
                </div>
            </div>
        </div>

        <!-- Integration Guide -->
        <div class="card mt-4">
            <div class="card-header bg-dark text-white">
                <h5>üîß Guia de Integra√ß√£o</h5>
            </div>
            <div class="card-body">
                <h6>üöÄ Ordem de Inicializa√ß√£o:</h6>
                <ol>
                    <li><strong>Porta 5000:</strong> <code>python app.py</code> (API Flask - Sistema Trading)</li>
                    <li><strong>Porta 5001:</strong> <code>python django_server/manage.py runserver</code> (Dashboard Django)</li>
                    <li><strong>Porta 3000:</strong> <code>cd mcp-trader && npm start</code> (MCP Server LLM)</li>
                </ol>

                <h6>üìä Verifica√ß√£o de Funcionamento:</h6>
                <pre><code># Health checks
curl http://localhost:5000/health     # üîß API Flask
curl http://localhost:5001/quant/mlp/ # üìä Django Dashboard
curl http://localhost:3000/health     # ü§ñ MCP Server
curl http://localhost:5000/bot/health # ‚ö° API Bot integrada</code></pre>

                <h6>üéØ Testes Completos:</h6>
                <p>Use os comandos acima para testar todas as funcionalidades do sistema de trading automatizado.</p>
            </div>
        </div>

        <hr class="mt-5">
        <footer class="text-center text-muted mt-4">
            <p>¬© 2025 MLP Trading System - Documenta√ß√£o T√©cnica Completa</p>
            <small>üèÜ Sistema de Trading Profissional com IA e Integra√ß√£o MetaTrader</small>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
